---
interface Feature {
  id: string;
  title: string;
  usecase: string;
  explanation: string;
  video: string;
  color: 'ari' | 'bada' | 'chorong';
}

const base = import.meta.env.BASE_URL;

const features: Feature[] = [
  {
    id: 'multi-context',
    title: 'Multi-Context Access',
    usecase: 'Comparing staging and production deployments at a glance.',
    explanation: 'Connect to multiple clusters simultaneously and switch between contexts instantly. No more juggling terminal windows or re-running kubectl commands.',
    video: `${base}assets/kattle-multi-context.mp4`,
    color: 'ari',
  },
  {
    id: 'field-tree',
    title: 'Dynamic Field Tree',
    usecase: 'Selecting deep and verbose fields without typos.',
    explanation: 'Select any path with a click, no matter how deep or verbose the field names. Forget about jq queries like <code>.spec.containers[0].image</code> or <code>.metadata.annotations["kubernetes.io/config.hash"]</code> from now on.',
    video: `${base}assets/kattle-dynamic-field-tree.mp4`,
    color: 'bada',
  },
  {
    id: 'result-table',
    title: 'Realtime DIY Table',
    usecase: 'Tracking deployment replicas during a rolling update.',
    explanation: 'Build your own table with any fields you need — readyReplicas, availableReplicas, updatedReplicas, and more. Watch values update in real-time as your rollout progresses.',
    video: `${base}assets/kattle-realtime-diy-table.mp4`,
    color: 'chorong',
  },
  {
    id: 'favorite-views',
    title: 'Favorite Views',
    usecase: 'Reusing the same field selections across clusters.',
    explanation: 'Save your carefully crafted field selections as named views. Load them on any cluster with a single click — your monitoring setup is always ready wherever you go.',
    video: `${base}assets/kattle-favorite-views.mp4`,
    color: 'ari',
  },
];

const colorStyles = {
  ari: {
    text: 'text-kattle-ari',
    border: 'border-kattle-ari/40',
    bg: 'bg-kattle-ari/5',
  },
  bada: {
    text: 'text-kattle-bada',
    border: 'border-kattle-bada/40',
    bg: 'bg-kattle-bada/5',
  },
  chorong: {
    text: 'text-kattle-chorong',
    border: 'border-kattle-chorong/40',
    bg: 'bg-kattle-chorong/5',
  },
};
---

<section class="py-24">
  <div class="container-narrow">
    <div class="mb-16 text-center">
      <h2 class="mb-4 text-3xl font-bold text-white sm:text-4xl">
        Features
      </h2>
      <p class="mx-auto max-w-2xl text-lg text-neutral-300">
        <code class="rounded bg-kattle-bada/20 px-2 py-0.5 text-kattle-bada">kubectl + jq</code> as a GUI.
        <br />
        Pick any field you want, no complex queries needed.
      </p>
    </div>

    <div class="space-y-20">
      {features.map((feature, index) => {
        const style = colorStyles[feature.color];
        const isReversed = index % 2 === 1;
        return (
          <div class={`relative flex flex-col gap-8 lg:flex-row lg:items-center lg:gap-12 ${isReversed ? 'lg:flex-row-reverse' : ''}`}>
            {/* Background gradient - outside of video */}
            <div class={`absolute top-1/2 -translate-y-1/2 h-[400px] w-[400px] rounded-full ${style.bg.replace('/5', '/20')} blur-[120px] -z-10 ${isReversed ? '-right-32' : '-left-32'}`}></div>

            {/* Video/Demo Container */}
            <div class="flex-[3]">
              <div class={`aspect-video overflow-hidden rounded-xl border-2 transition-transform duration-300 hover:scale-[1.2] ${style.border} ${style.bg}`}>
                <video
                  class="h-full w-full object-cover"
                  src={feature.video}
                  autoplay
                  loop
                  muted
                  playsinline
                />
              </div>
            </div>

            {/* Text Content */}
            <div class={`flex-[2] ${isReversed ? 'lg:pr-8' : 'lg:pl-8'}`}>
              <h3 class={`mb-4 text-2xl font-bold ${style.text}`}>
                {feature.title}
              </h3>
              <p class="mb-3 text-lg text-neutral-300 italic">
                "{feature.usecase}"
              </p>
              <p class="text-neutral-400 [&>code]:rounded [&>code]:bg-kattle-bada/20 [&>code]:px-1.5 [&>code]:py-0.5 [&>code]:text-kattle-bada [&>code]:text-sm" set:html={feature.explanation}>
              </p>
            </div>
          </div>
        );
      })}
    </div>
  </div>
</section>
